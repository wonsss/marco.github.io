---
title: 멘션 알림 기능 구현(contenteditable 속성, MutationObserver API)
date: 2022-10-30 05:10:66
category: draft
thumbnail: { thumbnailSrc }
draft: true
---

사용자들이 댓글로 소통할 때, 본인을 언급한 댓글에 대한 알림 기능이 없어서 소통이 금방 끊긴다는 피드백을 받았다. 이를 해결하기 위해 React와 JavaScript로 여러 SNS에서 볼 수 있는 @ 멘션 알림 기능을 직접 구현하였다.

구현하려는 멘션 기능의 시나리오는 다음과 같다.

- 입력창에 '@'를 치면 전체 사용자들이 팝업에 표시된다.
  - '@' 앞에는 @와 연속되 다른 문자열이 없어야 한다.
- '@' 바로 뒤에 띄어쓰기 없이 입력된 문자열로 사용자를 검색하고, 검색된 사용자들이 팝업에 표시된다.
  - '@' 바로 뒤에 문자열 입력하다가 공백이 입력되면 사용자 선택 팝업이 닫힌다.
- 팝업에서 언급할 상대를 고르면 @부터 선택된 닉네임까지의 문자열이 스타일된 컴포넌트로 변경된다. (ex, '@마르코' -> `@마르코`)
- 입력창에서 선택된 닉네임 컴포넌트(ex, `@마르코`)에게 delete나 backspace를 한번만 입력하면 해당 닉네임 컴포넌트가 바로 삭제된다.
- 하나의 입력창에서 여러 개의 멘션을 할 수 있다.
- 위와 같은 방법을 통해 언급할 상대를 고르고 난 후 메세지를 작성하면, 멘션한 상대방들에게 푸시 알림이 전송된다.

그러나 기존에 사용하던 input이나 textarea 요소로는 편집하던 텍스트가 다른 요소로 변경되어야 하는 멘션 기능의 요구사항을 충족할 수 없었다.

이처럼 기본 HTML 요소의 기능만으로는 구현할 수 없었던 멘션 기능을 `contentEditable` 속성과 `MutationObserver API`를 사용함으로써 직접 구현해보았다.

## contenteditable

[contenteditable](https://developer.mozilla.org/ko/docs/Web/HTML/Global_attributes/contenteditable)은 해당 요소를 사용자가 편집할 수 있도록 허용(true)할 수 있는 속성이다. 이 속성은 모든 HTML 요소(일부 요소에는 아무 효과도 없을 수 있으나)에 지정할 수 있는 전역 특성이다. input이나 textarea와 같은 입력 요소 대신에 입력과 해당 컴포넌트의 수정을 유연하게 하기 위해 contenteditable을 선택했다.

## 입력창에 '@'를 치면 전체 사용자들이 팝업에 표시된다
